<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8' />
		<meta http-equiv="X-UA-Compatible" content="chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<meta name="msvalidate.01" content="BFF6A5C0505C557ED95FF6AD05C0CEF2" />
		<meta name="baidu-site-verification" content="uscdVavdsc" />
		<title>./echo X</title>
		<link rel="stylesheet" type="text/css" href="/stylesheets/stylesheet.css" media="screen" />
		<link rel="stylesheet" type="text/css" href="/stylesheets/pygment_trac.css" media="screen" />
		<script type="text/javascript" src="/javascripts/jquery.js"></script>
		<script src="/javascripts/scale.fix.js"></script>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

<!--
		<script type="text/javascript">

		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-30955754-1']);
		  _gaq.push(['_trackPageview']);

		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();

		</script>
-->
	</head>

	<body>
		<div class="wrapper">
			<header>
				<div class="container">
					<h1 class="header"><a href="/">./echo X</a></h1>
					<p class="header"></p>

					<ul>
						<li><a class="buttons js-projects" href="/projects.html">Projects</a></li>
						<li><a class="buttons" href="http://www.flickr.com/photos/55770412@N08/" target="_blank">Photos</a></li>
						<li><a class="buttons" href="http://about.me/tkdchen" target="_blank">About me</a></li>
						<li><a class="buttons github" href="https://github.com/tkdchen/mysite">View On GitHub</a></li>
					</ul>

					<div class="follow-me">
						<a href="http://cn.linkedin.com/pub/chenxiong-qi/2b/a83/625/">
							<img src="/images/linkedin-logo.png" title="Link Me" width="24" height="24" />
						</a>
						<a href="https://plus.google.com/106047565908709135904">
							<img src="/images/gplus-icon.png" title="Goolg Plus" width="28" height="28" />
						</a>
						<a href="/feeds/all.xml">
							<img src="/images/rss.png" alt="RSS" width="24" height="24" />
						</a>
					</div>

					<div>
						<a href="http://setiathome.berkeley.edu" title="SETI@Home" target="_blank">
							<img src="http://setiathome.berkeley.edu/user_images/seti_button.png" title="SETI@Home" />
						</a>
					</div>

				</div>
			</header>

			<section>
				<div class="container"><div class="post-section">
	<div class="post-main-body">
	<h1>GTG的Bugzilla插件被重新实现为同步服务了</h1>
	<p>最近，完成了对Bugzilla插件的重写，重新实现为GTG的同步服务（Synchronization Service）。不得而知是何原因需要做这个转换。
您可以从<a href="https://bugs.launchpad.net/gtg/+bug/494967">Bug 494967</a>略之一二。</p>

<p>原始的插件实现提供了基本的Bug信息同步功能。在用户输入一个Bug链接后，Bugzilla插件会得到GTG的通知，根据URL中提供的远程Bugzilla服务的信息，
与之通信读取Bug信息并替换任务的主题和内容。同时，会把Bug的Component作为任务的标签。除了这些基本功能外，在我看来，有一点不足非常明显，即可配置程度不高。
它体现在几个方面。</p>

<ul>
<li><p>所支持的Bugzilla服务是不可配置的。这些服务是写死在代码里的，用户对它们做任何的控制。例如，用户无法添加一个GTG尚未知晓的Bugzilla服务。</p></li>
<li><p>标签同步的来源是不可配置的。标签的来源也是在代码里写死。用户没有任何选择的权力。Priority、Severity等Bug信息都是可以作为标签的很好的选项。
如果有用户需要使用它们作为标签，则必须代码才能够实现。另外，如果用户想指定额外的名称作为标签，同样也只能指望GTG的开发者。显然这不够理想。</p></li>
</ul>


<p>在开始重新实现为同步服务之前，我希望能保持原始的功能不做任何改动，以便尽可能保持用户的原有的用户体验。此外，既然是重新实现，
这也是个很好的重新考虑同步功能的好机会，借机改进Bugzilla同步服务，修改掉已知的一些问题。下面的几点是重写过程中所保持的和做出的改进。</p>

<ul>
<li><p>保持Bug信息同步的原始行为不变。不改变已有的用户体验。</p></li>
<li><p>标签同步的来源可配置。可指定哪些Bug信息可作为标签，以及可以输入自定义的标签名称。目前还不支持用户可以指定任意的Bug属性作为标签。
尽管各个Bugzilla服务都是基于相同Bugzilla项目，但不同的开源项目有其各自独特的管理需求，使得Bug属性也不尽相同。即便如此，它们也是有相同的部分，
例如Priority、Severity、Component和Status等。这些属性对于开发者来说，都是有意义的。因此，我决定在目前的版本中，首先支持这些共有的、
且极具实际用途的Bug属性。这样也能够降低在Bugzilla服务之间处理不同的Bug属性差异所带来的复杂度。</p></li>
<li><p>提供默认支持的Bugzilla服务列表，也允许用户增、删、改。在使用中，删除和编辑的可能性是不大的。显然，没有哪个项目会经常变动自己Bugzilla服务的域名。
但也显然的是，默认的列表不能穷举所有已经存在的Bugzilla服务。增的操作对于某些用户来说就显得很有必要了。</p></li>
<li><p>允许将Bug的第一个Comment作为任务的内容添加到任务中。这是一个很有用的选项。从我个人的角度来看，这个功能非常的有价值，
应该作为同步的一个步骤提供给用户而不是作为选项。为了保持原有的插件的同步行为不变，只能将此作为选项提供，且默认不勾选。</p></li>
<li><p>更友好的信息提示机制。同步Bug信息的过程中，可能会遇到各种各样的意外情况。提示信息包括这些意外情况中的多数应该让用户知道的内容。在插件实现中，
以及最初的同步服务实现中，我采取系统的通知机制（通过pynotify提供）。实践证明，尽管这种方式解决了问题，在GNOME和KDE以及其他常见的桌面环境中能够
以相对友好的方式显示提示消息，但似乎与GTG有些脱节。GTG本身提供了内置的消息提示机制。集成的通知机制，交互方便，能够将用户的注意力集中在GTG上发生的
所有的操作，这样有助于用户提高效率。Bugzilla同步服务也使用了此机制向用户推送必要的消息。</p></li>
</ul>


<p>目前，已经完成了第一个目标。原始的同步的功能能够正常工作。Bugzilla同步服务的配置对话框如下图1所示。</p>

<p><img src="/images/blog/gtg-bugzilla-sync-service-config-dialog.png" alt="Bugzilla Synchronization Service Config Dialog" /></p>

<p>同步结果入下图2所示。</p>

<p><img src="/images/blog/gtg-bugzilla-sync-demo.png" alt="Bugzilla Synchronization Demo" /></p>

<p>从上图中能看到，已经有两个两个任务获得了对应的Bug的信息。另外两个没有同步成功，其中一个原因被显示在了对话框中央的提示区域中。</p>

<p>您可以从这里获得代码尝鲜，<a href="https://github.com/getting-things-gnome/gtg/pull/55">https://github.com/getting-things-gnome/gtg/pull/55</a></p>

<p>Bugzilla同步服务的配置功能还没有完成。这是下一步要做的主要工作。不得不提的是，同步服务的配置对话框限制了开发者向其添加自定义窗口部件的能力。
GTG采取了声明式的实现方式。它内置了有限的几种对应到不同类型的配置参数的窗口部件。配置区域是自动生成的。不爽的是，它没有暴露必要的接口以允许
开发者添加自定义的内容。历经近一段时间的摸索，没有得到任何答案。GTG的开发者邮件列表也没有反馈。所以，在上图1中，您没有看到默认提供的Bugzilla服务的列表。
接下来，这是首要解决的问题。</p>

	</div>
	<div class="post-footer">
		<p>Written on: 15 Sep 2014</p>
		<p>Tags:
		
		<a href="/tags.html#GNOME">GNOME</a>
		
		<a href="/tags.html#GTG">GTG</a>
		
		</p>
		<div class="share-section">
			<p>Share to: </p>
			<ul>
				<li><!-- Share to Google plus -->
					<div class="g-plusone"  data-annotation="none"></div>
					<script type="text/javascript">
					(function() {
						var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
						po.src = 'https://apis.google.com/js/plusone.js';
						var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
					})();
					</script>
				</li>
			</ul>
			</ul>
		</div>
	</div>
	<div id="comments" class="post-comment">
		<div id="disqus_thread"></div>
		<script type="text/javascript">
				/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
				var disqus_shortname = 'tkdchen'; // required: replace example with your forum shortname

				/* * * DON'T EDIT BELOW THIS LINE * * */
				(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>
</div>
</div>
			</section>

			<footer>
				<p>
					&copy; Chenxiong Qi, 2014. Powered by <a href="https://github.com/mojombo/jekyll/" target="_blank">Jekyll</a>
				</p>
			</footer>
		</div>

	</body>
</html>
